<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>StudyBuddy AI â€“ MAX OMEGA</title>
<style>
body{
  margin:0;
  font-family:Segoe UI,Arial;
  background:linear-gradient(135deg,#00b3ff,#0044cc);
  color:white;
  display:flex;
  flex-direction:column;
  height:100vh;
}

header{
  padding:12px;
  text-align:center;
  font-weight:bold;
  font-size:20px;
  background:rgba(0,0,0,0.25);
}

#dashboard{
  display:flex;
  justify-content:space-around;
  font-size:12px;
  padding:6px;
  background:rgba(0,0,0,0.2);
}

#chat{
  flex:1;
  overflow-y:auto;
  padding:10px;
}

.msg{
  margin:6px 0;
  padding:8px 12px;
  border-radius:10px;
  max-width:75%;
  animation:fade 0.3s ease;
}

@keyframes fade{
  from{opacity:0;transform:translateY(5px);}
  to{opacity:1;transform:translateY(0);}
}

.user{
  background:white;
  color:black;
  align-self:flex-end;
}

.bot{
  background:rgba(255,255,255,0.2);
}

#controls{
  display:flex;
  padding:8px;
  background:rgba(0,0,0,0.2);
}

#input{
  flex:1;
  padding:8px;
  border:none;
  border-radius:6px;
  outline:none;
}

button,select{
  margin-left:4px;
  padding:6px;
  border:none;
  border-radius:6px;
  cursor:pointer;
}

.theme-dark{
  background:black;
}

.theme-light{
  background:white;
  color:black;
}
</style>
</head>
<body>

<header>ğŸ’ StudyBuddy AI â€“ MAX OMEGA</header>

<div id="dashboard">
  <div>â­ XP: <span id="xp">0</span></div>
  <div>ğŸ† Level: <span id="level">1</span></div>
  <div>ğŸ”¥ Focus: <span id="focus">0</span></div>
  <div>ğŸ– Ach: <span id="ach">0</span></div>
</div>

<div id="chat"></div>

<div id="controls">
  <input id="input" placeholder="Type..."/>
  <select id="mode">
    <option value="friendly">Friendly</option>
    <option value="motivator">Motivator</option>
    <option value="strict">Strict</option>
    <option value="calm">Calm</option>
    <option value="islamic">Islamic</option>
  </select>
  <button onclick="send()">Send</button>
</div>

<script>

/* ============================
   STORAGE SYSTEM
============================ */

let data = JSON.parse(localStorage.getItem("maxAI")) || {
  xp:0,
  level:1,
  focus:0,
  achievements:[],
  personality:"friendly",
  name:"",
  goals:[],
  habits:[],
  notes:[],
  streak:1
};

function save(){
  localStorage.setItem("maxAI",JSON.stringify(data));
}

function updateUI(){
  xp.innerText=data.xp;
  level.innerText=data.level;
  focus.innerText=data.focus;
  ach.innerText=data.achievements.length;
  mode.value=data.personality;
}

updateUI();

/* ============================
   XP + LEVEL SYSTEM
============================ */

function addXP(n){
  data.xp+=n;
  if(data.xp>=data.level*100){
    data.xp=0;
    data.level++;
    addMsg("ğŸ‰ Level Up! Now Level "+data.level,"bot");
    unlockAchievement("Level "+data.level);
  }
  save();
  updateUI();
}

function unlockAchievement(name){
  if(!data.achievements.includes(name)){
    data.achievements.push(name);
    addMsg("ğŸ… Achievement: "+name,"bot");
    save();
    updateUI();
  }
}

/* ============================
   CHAT SYSTEM
============================ */

function addMsg(text,type){
  const d=document.createElement("div");
  d.className="msg "+type;
  d.textContent=text;
  chat.appendChild(d);
  chat.scrollTop=9999;
}

function send(){
  const text=input.value.trim();
  if(!text) return;
  addMsg(text,"user");
  input.value="";
  addXP(5);
  setTimeout(()=>addMsg(getAI(text),"bot"),300);
}

/* ============================
   AI CORE (ALL FEATURES)
============================ */

let lastTopic="";

function getAI(q){
  q=q.toLowerCase().trim();
  data.personality=mode.value;
  save();

  // Name memory
  if(q.startsWith("my name is")){
    data.name=q.replace("my name is","").trim();
    save();
    return "Nice to meet you, "+capitalize(data.name);
  }

  if(q.includes("remember my name")){
    return data.name? "Your name is "+capitalize(data.name)
                    :"Tell me your name using 'my name is ...'";
  }

  // Greetings
  if(["hi","hello","hey"].includes(q))
    return style("Hello "+(data.name?capitalize(data.name):"")+"!");

  if(q.includes("how are you"))
    return style("Always ready to help you grow.");

  if(q.includes("who are you"))
    return style("I am StudyBuddy AI MAX OMEGA.");

  if(q.includes("what can you do"))
    return style("Study plans, focus sessions, goals, habits, notes, math, motivation, leveling.");

  // Motivation
  if(q.includes("motivation")){
    lastTopic="motivation";
    return style("Success = discipline repeated daily.");
  }

  if(q.includes("continue")){
    if(lastTopic==="motivation")
      return style("Keep pushing even when motivation fades.");
    if(lastTopic==="study")
      return style("Stay focused. Deep work creates results.");
  }

  // Study
  if(q.includes("study")){
    lastTopic="study";
    data.focus++;
    save();
    updateUI();
    unlockAchievement("First Study");
    return style("Break topic into chunks. Master one at a time.");
  }

  if(q.includes("focus")){
    startFocus();
    return style("25 minute focus started.");
  }

  // Goals
  if(q.startsWith("add goal")){
    const g=q.replace("add goal","").trim();
    data.goals.push(g);
    save();
    return style("Goal added: "+g);
  }

  if(q.includes("show goals")){
    return data.goals.length?data.goals.join(" | "):"No goals yet.";
  }

  // Habits
  if(q.startsWith("add habit")){
    const h=q.replace("add habit","").trim();
    data.habits.push(h);
    save();
    return "Habit added: "+h;
  }

  if(q.includes("show habits")){
    return data.habits.join(" | ") || "No habits.";
  }

  // Notes
  if(q.startsWith("note")){
    data.notes.push(q.replace("note","").trim());
    save();
    return "Note saved.";
  }

  if(q.includes("show notes")){
    return data.notes.join(" | ") || "No notes.";
  }

  // Math
  if(/^[0-9\.\+\-\*\/\(\)\s]+$/.test(q)){
    try{
      return "Answer: "+Function('"use strict";return ('+q+')')();
    }catch{return "Invalid math";}
  }

  // Voice
  if(q==="speak"){
    speak("You are doing great. Keep going.");
    return "Speaking...";
  }

  return style("Try study, motivation, focus, goals, habits, or math.");
}

/* ============================
   PERSONALITY SYSTEM
============================ */

function style(text){
  switch(data.personality){
    case "motivator": return "ğŸ”¥ "+text+" No excuses.";
    case "strict": return "ğŸ¯ "+text+" Stay disciplined.";
    case "calm": return "ğŸŒ¿ "+text+" Breathe and continue.";
    case "islamic": return "ğŸ¤ "+text+" Allah sees your effort.";
    default: return "ğŸ’™ "+text;
  }
}

/* ============================
   FOCUS TIMER
============================ */

function startFocus(){
  let t=25;
  const i=setInterval(()=>{
    t--;
    if(t<=0){
      clearInterval(i);
      addMsg("â° Focus complete!","bot");
      addXP(20);
      unlockAchievement("Focus Master");
    }
  },60000);
}

/* ============================
   VOICE SYSTEM
============================ */

function speak(text){
  const u=new SpeechSynthesisUtterance(text);
  speechSynthesis.speak(u);
}

function capitalize(str){
  return str.charAt(0).toUpperCase()+str.slice(1);
}

addMsg("ğŸ‘‹ Welcome to MAX OMEGA StudyBuddy AI.","bot");

</script>
</body>
</html>
